RuleID,Command,Notes
SV-238206r958518,grep sudo /etc/group,Verify the sudo group has only members who should have access to security functions
SV-238215r958908,sudo dpkg -l | grep openssh,Verify the SSH package is installed
SV-238215r958908,"sudo systemctl status sshd.service | egrep -i ""(active|loaded)""","Verify the ""sshd.service"" is loaded and active with the following command"
SV-238380r991589,sudo systemctl status ctrl-alt-del.target,"Check that the ""ctrl-alt-del.target"" (otherwise also known as reboot.target) is not active"
SV-274857r1101692,grep -i ldap_user_certificate /etc/sssd/sssd.conf,"Verify that authenticated certificates are mapped to the appropriate user group in the ""/etc/sssd/sssd.conf"" file"
SV-238205r958482,"awk -F "":"" 'list[$3]++{print $1, $3}' /etc/passwd",Verify the Ubuntu operating system contains no duplicate User IDs (UIDs) for interactive users
SV-238207r1069086,"sudo grep -E ""\bTMOUT=[0-9]+"" /etc/bash.bashrc /etc/profile.d/*","Check that the ""TMOUT"" environment variable is set in the ""/etc/bash.bashrc"" file or in any file inside the ""/etc/profile.d/"" directory"
SV-238243r958424,sudo grep '^action_mail_acct = root' /etc/audit/auditd.conf,Verify that the SA and ISSO (at a minimum) are notified in the event of an audit processing failure
SV-238245r958434,sudo grep -iw log_file /etc/audit/auditd.conf,Determine where the audit logs are stored
SV-238245r958434,"sudo stat -c ""%n %a"" /var/log/audit/*","Using the path of the directory containing the audit logs, determine if the audit log files have a mode of ""0600"" or less"
SV-238246r958434,sudo grep -iw log_file /etc/audit/auditd.conf,Determine where the audit logs are stored
SV-238246r958434,"sudo stat -c ""%n %U"" /var/log/audit/*","Using the path of the directory containing the audit logs, determine if the audit log files are owned by the ""root"" user"
SV-238246r958434,sudo grep -iw log_group /etc/audit/auditd.conf,Determine where the audit logs are stored
SV-238246r958434,"sudo stat -c ""%n %G"" /var/log/audit/*","Using the path of the directory containing the audit log files, determine if the audit log files are owned by the ""root"" group"
SV-238303r991567,egrep '(\/sbin\/(audit|au))' /etc/aide/aide.conf,Check the selection lines that AIDE is configured to add/check
SV-238309r958846,sudo auditctl -l | grep sudo.log,Check the currently configured audit rules
SV-238324r1069955,"grep -E -r '^(auth,authpriv\.\*|daemon\.\*)' /etc/rsyslog.*",Check that remote access methods are being logged
SV-238328r958480,sudo ufw show raw,"Check the firewall configuration for any unnecessary or prohibited functions, ports, protocols, and/or services"
SV-238329r1015153,sudo passwd -S root,Verify the Ubuntu operating system prevents direct logins to the root account
SV-238334r958550,systemctl is-active kdump.service,Verify that kernel core dumps are disabled
SV-238344r991559,"find /bin /sbin /usr/bin /usr/sbin /usr/local/bin /usr/local/sbin -perm /022 -type d -exec stat -c ""%n %a"" '{}' \;",Verify the system commands directories have mode 0755 or less
SV-238345r991559,"sudo find /bin /sbin /usr/bin /usr/sbin /usr/local/bin /usr/local/sbin ! -user root -type d -exec stat -c ""%n %U"" '{}' \;",Verify the system commands directories are owned by root
SV-238346r991559,"sudo find /bin /sbin /usr/bin /usr/sbin /usr/local/bin /usr/local/sbin ! -group root -type d -exec stat -c ""%n %G"" '{}' \;",Verify the system commands directories are group-owned by root
SV-238347r1106136,"sudo find /lib /lib64 /usr/lib /usr/lib64 -type f -name '*.so*' -perm /022 -exec stat -c ""%n %a"" {} +",Check that the systemwide shared library files have mode 0755 or less permissive
SV-238348r991560,"sudo find /lib /lib64 /usr/lib -perm /022 -type d -exec stat -c ""%n %a"" '{}' \;","Verify the system-wide shared library directories ""/lib"", ""/lib64"", and ""/usr/lib have mode 0755 or less permissive"
SV-238349r1106138,"sudo find /lib /lib64 /usr/lib /usr/lib64 -type f -name '*.so*' ! -user root -exec stat -c ""%n %U"" {} +","Verify the systemwide shared library files contained in the directories ""/lib"", ""/lib64"", ""/usr/lib"", and ""/usr/lib64"" are owned by root"
SV-238350r991560,"sudo find /lib /usr/lib /lib64 ! -user root -type d -exec stat -c ""%n %U"" '{}' \;","Verify the system-wide shared library directories ""/lib"", ""/lib64"", and ""/usr/lib"" are owned by root"
SV-238351r1106140,"sudo find /lib /lib64 /usr/lib /usr/lib64 -type f -name '*.so*' ! -group root -exec stat -c ""%n %G"" {} +","Verify the systemwide shared library files contained in the directories ""/lib"", ""/lib64"", ""/usr/lib"", and ""/usr/lib64"" are group owned by root"
SV-238352r991560,"sudo find /lib /usr/lib /lib64 ! -group root -type d -exec stat -c ""%n %G"" '{}' \;","Verify the system-wide library directories ""/lib"", ""/lib64"", and ""/usr/lib"" are group-owned by root"
SV-238355r958672,systemctl is-enabled ufw,Verify the Uncomplicated Firewall is enabled on the system
SV-238355r958672,systemctl is-active ufw,Verify the Uncomplicated Firewall is active on the system
SV-238364r958868,nan,"Verify the directory containing the root certificates for the Ubuntu operating system contains certificate files for DoD PKI-established certificate authorities by iterating over all files in the ""/etc/ssl/certs"" directory and checking if, at least one, has the subject matching ""DOD ROOT CA"""
SV-238372r958948,sudo grep SILENTREPORTS /etc/default/aide,Verify that Advanced Intrusion Detection Environment (AIDE) notifies the System Administrator  when anomalies in the operation of any security functions are discovered
SV-238374r991593,"systemctl status ufw.service | grep -i ""active:""","systemctl status ufw.service | grep -i ""active:"""
SV-238377r991560,"sudo find /bin /sbin /usr/bin /usr/sbin /usr/local/bin /usr/local/sbin ! -user root -type f -exec stat -c ""%n %U"" '{}' \;",Verify the system commands contained in the following directories are owned by root
SV-238378r991560,"sudo find -L /bin /sbin /usr/bin /usr/sbin /usr/local/bin /usr/local/sbin ! -group root -type f ! -perm /2000 -exec stat -c ""%n %G"" '{}' \;",Verify the system commands contained in the following directories are group-owned by root
SV-255912r991554,sudo /usr/sbin/sshd -dd 2>&1 | awk '/filename/ {print $4}' | tr -d '\r' | tr '\n' ' ' | xargs sudo grep -iH '^\s*kexalgorithms',Verify the SSH server is configured to use only FIPS-validated key exchange algorithms
SV-274853r1106127,dpkg -l | grep sssd,Verify Ubuntu 20.04 LTS has the packages required for multifactor authentication installed
SV-274854r1106129,sudo systemctl is-enabled sssd,"Verify the ""sssd.service"" is enabled"
SV-274854r1106129,sudo systemctl is-active sssd,"Verify the ""sssd.service"" is active"
SV-274855r1107182,sudo grep -A 1 '^\[sssd\]' /etc/sssd/sssd.conf,Verify the pam service is listed under [sssd]
SV-274855r1107182,sudo grep -A 1 '^\[pam]' /etc/sssd/sssd.conf,Verify the pam service is set to use pam for smart card authentication in the [pam] section of /etc/sssd/sssd.conf
SV-274855r1107182,sudo grep certificate_verification /etc/sssd/sssd.conf,"Verify ""ca"" is enabled in ""certificate_verification"""
SV-274858r1106125,sudo grep -iwR 'ALL' /etc/sudoers /etc/sudoers.d/ | grep -v '#',Verify the operating system restricts privilege elevation to authorized personnel with the following command
SV-274859r1101698,sudo egrep -iR 'NOPASSWD' /etc/sudoers /etc/sudoers.d/,"Verify that ""/etc/sudoers"" has no occurrences of ""NOPASSWD"""
SV-238234r1015152,grep -i remember /etc/pam.d/common-password,Verify the Ubuntu operating system prevents passwords from being reused for a minimum of five generations
SV-238307r971542,sudo grep ^space_left_action /etc/audit/auditd.conf,Verify the Ubuntu operating system notifies the SA and ISSO (at a minimum) when allocated audit record storage volume reaches 75% of the repository maximum audit record storage capacity
SV-238307r971542,sudo grep ^space_left /etc/audit/auditd.conf,Verify the Ubuntu operating system notifies the SA and ISSO (at a minimum) when allocated audit record storage volume reaches 75% of the repository maximum audit record storage capacity
SV-238307r971542,sudo grep ^action_mail_acct /etc/audit/auditd.conf,Verify the Ubuntu operating system notifies the SA and ISSO (at a minimum) when allocated audit record storage volume reaches 75% of the repository maximum audit record storage capacity
SV-238308r958788,"timedatectl status | grep -i ""time zone""",To verify the time zone is configured to use UTC or GMT
SV-238321r959008,sudo ls /etc/cron.weekly,Verify there is a script that offloads audit data and that script runs weekly.
SV-238362r958828,sudo grep offline_credentials_expiration /etc/sssd/sssd.conf /etc/sssd/conf.d/*.conf,Verify that PAM prohibits the use of cached authentications after one day
SV-255913r958524,sudo sysctl kernel.dmesg_restrict,Verify the operating system is configured to restrict access to the kernel message buffer
SV-255913r958524,sudo grep -r kernel.dmesg_restrict /run/sysctl.d/* /etc/sysctl.d/* /usr/local/lib/sysctl.d/* /usr/lib/sysctl.d/* /lib/sysctl.d/* /etc/sysctl.conf 2> /dev/null,Check that the configuration files are present to enable this kernel parameter
SV-274856r1106132,sudo grep offline_credentials_expiration /etc/sssd/sssd.conf /etc/sssd/conf.d/*.conf,Verify that PAM prohibits the use of cached authentications after one day
